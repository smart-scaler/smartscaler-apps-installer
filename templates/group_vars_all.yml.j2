---
# Kubernetes configuration
kube_version: v1.32.5
kube_network_plugin: "{{ kubernetes_deployment.network_plugin | default('calico') }}"
container_manager: "{{ kubernetes_deployment.container_runtime | default('containerd') }}"
dns_mode: "{{ kubernetes_deployment.dns_mode | default('coredns') }}"

# Network configuration
kube_service_addresses: "{{ kubernetes_deployment.network_config.service_subnet | default('10.233.0.0/18') }}"
kube_pods_subnet: "{{ kubernetes_deployment.network_config.pod_subnet | default('10.233.64.0/18') }}"
kube_network_node_prefix: {{ kubernetes_deployment.network_config.node_prefix | default(24) }}

# API Server Configuration
kube_apiserver_ip: "{{ kubernetes_deployment.api_server.host }}"
apiserver_loadbalancer_domain_name: "{{ kubernetes_deployment.api_server.host }}"
loadbalancer_apiserver:
  address: "{{ kubernetes_deployment.api_server.host }}"
  port: {{ kubernetes_deployment.api_server.port }}

# SSL Configuration
supplementary_addresses_in_ssl_keys: {{ supplementary_addresses_in_ssl_keys }}

# Additional Kubernetes Configuration
{% if kubernetes_deployment.additional_vars is defined %}
{% for key, value in kubernetes_deployment.additional_vars.items() %}
{{ key }}: {{ value }}
{% endfor %}
{% endif %}

# NVIDIA Configuration
{% if kubernetes_deployment.nvidia_runtime.enabled | default(false) %}
nvidia_accelerator_enabled: true
nvidia_driver_install_container: true
nvidia_container_runtime_package_architecture: "{{ kubernetes_deployment.nvidia_runtime.architecture | default('amd64') }}"
{% endif %} 